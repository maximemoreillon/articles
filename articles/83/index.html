<!DOCTYPE html>
<html lang="en-us"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">IoT Current consumption monitoring system | Maxime Moreillon</title>
<meta property="og:title" content="IoT Current consumption monitoring system | Maxime Moreillon" />
<meta name="twitter:title" content="IoT Current consumption monitoring system | Maxime Moreillon" />
<meta itemprop="name" content="IoT Current consumption monitoring system | Maxime Moreillon" />
<meta name="application-name" content="IoT Current consumption monitoring system | Maxime Moreillon" />
<meta property="og:site_name" content="" />

<meta name="description" content="">
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en" href="https://articles.maximemoreillon.com/articles/83/" title="" />






<meta name="generator" content="Hugo 0.147.8">

    
    <meta property="og:url" content="https://articles.maximemoreillon.com/articles/83/">
  <meta property="og:site_name" content="Maxime Moreillon">
  <meta property="og:title" content="IoT Current consumption monitoring system">
  <meta property="og:description" content="When you don’t know how much power your air conditioner draws, it’s easy to leave it running without feeling too guilty. And then the electricity bill comes…
The objective of this project is to get an approximate measurement of how much electric power is being used in my apartment. Additionally, for the sake of safety, the measurement system should not require altering the electrical wiring currently in place. In other words, the measurement should be non-invasive.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2020-03-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2022-07-23T00:00:00+00:00">
    <meta property="article:tag" content="MQTT">
    <meta property="article:tag" content="Projects">
    <meta property="article:tag" content="IoT">
    <meta property="article:tag" content="Node.js">
    <meta property="article:tag" content="Electronics">
    <meta property="article:tag" content="InfluxDB">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="IoT Current consumption monitoring system">
  <meta name="twitter:description" content="When you don’t know how much power your air conditioner draws, it’s easy to leave it running without feeling too guilty. And then the electricity bill comes…
The objective of this project is to get an approximate measurement of how much electric power is being used in my apartment. Additionally, for the sake of safety, the measurement system should not require altering the electrical wiring currently in place. In other words, the measurement should be non-invasive.">


    

    <link rel="canonical" href="https://articles.maximemoreillon.com/articles/83/">
    <link href="/style.min.e390ba7da26222f4dc42a349955d76dbbe44e5ce2535a43de5a70633a0a9ec3c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://articles.maximemoreillon.com/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">
    <meta name="color-scheme" content="light dark">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
    
</head>
<body data-theme = "" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://articles.maximemoreillon.com/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/articles/">
                        Articles
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/tags/">
                        Tags
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">IoT Current consumption monitoring system</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2020-03-09T00:00:00&#43;00:00" itemprop="datePublished"> Mar 9, 2020 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p>When you don&rsquo;t know how much power your air conditioner draws, it&rsquo;s easy to leave it running without feeling too guilty. And then the electricity bill comes&hellip;</p>
<p>The objective of this project is to get an approximate measurement of how much electric power is being used in my apartment. Additionally, for the sake of safety, the measurement system should not require altering the electrical wiring currently in place. In other words, the measurement should be non-invasive.</p>
<p>To this end, I built a current measuring system based on transformers (CT) and an ESP32 Wifi microcontroller.</p>
<p>The system is installed on the breaker box of my apartment.</p>
<p><img src="https://img.maximemoreillon.com/images/5e786e4b6f2c2a628a19cad5" alt=""></p>
<p>This system has been designed following <a href="https://learn.openenergymonitor.org/electricity-monitoring/ct-sensors/interface-with-arduino">the instructions provided by openeneregymonitor.org</a>, which does a far better job at explaining how things work than I possibly could. At the moment, I am only measuring current, which limits me to computing my apartment&rsquo;s <a href="https://www.allaboutcircuits.com/textbook/alternating-current/chpt-11/true-reactive-and-apparent-power/">aparent power consumption, as opposed to its true power consumption</a>.</p>
<p><img src="https://img.maximemoreillon.com/images/5e7993432143b0076cbdf008" alt=""></p>
<p>The electrical system of my apartment is in a <a href="https://en.wikipedia.org/wiki/Split-phase_electric_power">split-phase configuration</a>. This required me to use two CT sensors, one per phase, as explained in <a href="https://pdfserv.maximintegrated.com/en/an/AN4843.pdf">this guide provided by Maxim Integrated</a>.</p>
<p><img src="https://img.maximemoreillon.com/images/5e7992fa2143b00811bdf006" alt=""></p>
<p>The CTs output are processed by an ESP32, which I chose over an ESP8266 because of its multiple ADCs. This allows for the periodic broadcast of the measurements over MQTT. Additionally, the ESP32 serves webpages for real-time visualizatation of the power consumption. The web server used to serve those pages also provides the ability to update the firmware running on the ESP32 for OTA updates.</p>
<p>Here is a list of the parts used in this project:</p>
<ul>
<li>ESP32 dev board</li>
<li>2x YHDC SCT-013-000 current transformer</li>
<li>2x 22Ω resistor (burden, a.k.a. shunt resistor for the CT)</li>
<li>2x 10kΩ resistor</li>
<li>10μF electrolytic capacitor</li>
</ul>
<p><img src="https://img.maximemoreillon.com/images/5e79931b2143b0ee5ebdf007" alt=""></p>
<p>Additionally, I created a NodeJS application to log the measurements in an InfluxDB. It comes with a front end built using VueJS.</p>
<p><img src="https://img.maximemoreillon.com/images/5e7992d02143b0293cbdf005" alt=""></p>
<p>The source code for this project is available on GitHub:</p>
<ul>
<li><a href="https://github.com/maximemoreillon/power_monitor_split_phase">ESP32 firmware</a></li>
<li><a href="https://github.com/maximemoreillon/current_consumption">Monitoring microservice back end</a></li>
<li><a href="https://github.com/maximemoreillon/current_consumption_front">Monitoring GUI</a></li>
</ul>
<p>More information about the electronics on <a href="https://oshwlab.com/m.moreillon/power_monitor">OSHWLab</a>.</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
</div>
    <small class="footer_copyright">
        © 2025 Maxime Moreillon.
        
    </small>
</footer>







    
    <script src="https://articles.maximemoreillon.com/js/main.min.4ee188e1744c19816e95a540b2650ed9f033ea0371e74eac8e717355cfca8741.js" integrity="sha256-TuGI4XRMGYFulaVAsmUO2fAz6gNx506sjnFzVc/Kh0E="></script>

    

</body>
</html>
