<!DOCTYPE html>
<html lang="en-us"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Resizing a hostpah-storage PVC and its PV in Microk8s | Maxime Moreillon</title>
<meta property="og:title" content="Resizing a hostpah-storage PVC and its PV in Microk8s | Maxime Moreillon" />
<meta name="twitter:title" content="Resizing a hostpah-storage PVC and its PV in Microk8s | Maxime Moreillon" />
<meta itemprop="name" content="Resizing a hostpah-storage PVC and its PV in Microk8s | Maxime Moreillon" />
<meta name="application-name" content="Resizing a hostpah-storage PVC and its PV in Microk8s | Maxime Moreillon" />
<meta property="og:site_name" content="" />

<meta name="description" content="">
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en" href="https://articles.maximemoreillon.com/articles/567/" title="" />






<meta name="generator" content="Hugo 0.147.8">

    
    <meta property="og:url" content="https://articles.maximemoreillon.com/articles/567/">
  <meta property="og:site_name" content="Maxime Moreillon">
  <meta property="og:title" content="Resizing a hostpah-storage PVC and its PV in Microk8s">
  <meta property="og:description" content="With the storage addon enabled, microk8s can automatically provision a PV when a PVC is created. The size of the PV is set according to that of the PVC. However, PVCs cannot be resized after creation. The PVC could be deleted and recreated with a larger size but this would result in the deletion of the PV and, by extension, all the data stored so far in it. This article presents a workaround to resize a PVC and its corresponding PV without any loss of data.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2021-10-21T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-10-26T00:00:00+00:00">
    <meta property="article:tag" content="Microk8s">
    <meta property="article:tag" content="Kubernetes">
    <meta property="article:tag" content="Tutorials">
    <meta property="article:tag" content="Medium">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Resizing a hostpah-storage PVC and its PV in Microk8s">
  <meta name="twitter:description" content="With the storage addon enabled, microk8s can automatically provision a PV when a PVC is created. The size of the PV is set according to that of the PVC. However, PVCs cannot be resized after creation. The PVC could be deleted and recreated with a larger size but this would result in the deletion of the PV and, by extension, all the data stored so far in it. This article presents a workaround to resize a PVC and its corresponding PV without any loss of data.">


    

    <link rel="canonical" href="https://articles.maximemoreillon.com/articles/567/">
    <link href="/style.min.e390ba7da26222f4dc42a349955d76dbbe44e5ce2535a43de5a70633a0a9ec3c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://articles.maximemoreillon.com/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">
    <meta name="color-scheme" content="light dark">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
    
</head>
<body data-theme = "" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://articles.maximemoreillon.com/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/articles/">
                        Articles
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/tags/">
                        Tags
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Resizing a hostpah-storage PVC and its PV in Microk8s</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2021-10-21T00:00:00&#43;00:00" itemprop="datePublished"> Oct 21, 2021 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p>With the storage addon enabled, microk8s can automatically provision a PV when a PVC is created. The size of the PV is set according to that of the PVC. However, PVCs cannot be resized after creation. The PVC could be deleted and recreated with a larger size but this would result in the deletion of the PV and, by extension, all the data stored so far in it. This article presents a workaround to resize a PVC and its corresponding PV without any loss of data.</p>
<p>First, let&rsquo;s start by creating a simple PVC with a size of 100Gb in the a Microk8s cluster using the following manifest:</p>
<pre tabindex="0"><code>apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: example-pvc
  namespace: example
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 100Gi
</code></pre><p>After being applied, the manifest creates the desired PVC:</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl apply -f example-pvc.yml
persistentvolumeclaim/example-pvc created
</code></pre><p>The PVC can be listed using kubectl:</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl get pvc -n example
NAME          STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS        AGE
example-pvc   Bound    pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4   100Gi      RWO            microk8s-hostpath   9s
</code></pre><p>The same goes for its corresponding PV:</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl get pv
NAME                                      CAPACITY  ACCESS MODES  RECLAIM POLICY  STATUS  CLAIM                STORAGECLASS
pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4  100Gi     RWO           Delete          Bound   example/example-pvc  microk8s-hostpath
</code></pre><p>Now let&rsquo;s assume that we want to change to storage size to 200Gb. Modifying the manifest and re-applying it would result in the following error: <em>only dynamically provisioned pvc can be resized and the storageclass that provisions the pvc must support resize</em></p>
<p>Here, one could delete the PVC and recreate it with a larger size, but this would result in the deletion of the PV and thus the data that it contains. Consequently, one must first prevent the PV to be deleted along with the PVC. This can be done by changing the <em>reclaim policy</em> of the PV from &ldquo;Delete&rdquo; (Microk8s default) to &ldquo;Retain&rdquo;. This can be achieved with the <em>microk8.kubectl patch</em> command:</p>
<pre tabindex="0"><code>microk8s.kubectl patch pv pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4 -p &#39;{&#34;spec&#34;:{&#34;persistentVolumeReclaimPolicy&#34;:&#34;Retain&#34;}}&#39;
</code></pre><p>Now, we can see that the reclaim policy of the PV has been changed to &ldquo;Retain&rdquo;:</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl get pv
NAME                                      CAPACITY  ACCESS MODES  RECLAIM POLICY  STATUS  CLAIM                STORAGECLASS
pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4  100Gi     RWO           Retain          Bound   example/example-pvc  microk8s-hostpath
</code></pre><p>This will prevent the PV to be deleted when the PVC is removed. We can thus go ahead and delete the PVC.</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl delete -f example-pvc.yml
persistentvolumeclaim &#34;example-pvc&#34; deleted
</code></pre><p>As a result, the PV should be marked as Released:</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl get pv
NAME                                      CAPACITY  ACCESS MODES  RECLAIM POLICY  STATUS    CLAIM                STORAGECLASS
pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4  100Gi     RWO           Retain          Released  example/example-pvc  microk8s-hostpath
</code></pre><p>Thus, the PV can be resized, which can also be achieved using the <em>microk8.kubectl patch</em> command:</p>
<pre tabindex="0"><code>microk8s.kubectl patch pv pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4 -p &#39;{&#34;spec&#34;:{&#34;capacity&#34;:{&#34;storage&#34;:&#34;200Gi&#34;}}}&#39;
</code></pre><p>The PV should now have a size of 200Gb.</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl get pv
NAME                                      CAPACITY  ACCESS MODES  RECLAIM POLICY  STATUS    CLAIM                STORAGECLASS
pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4  200Gi     RWO           Retain          Released  example/example-pvc  microk8s-hostpath
</code></pre><p>Before we can re-apply our PVC, we also need to make the PV ready to be bound again, i.e. set its status to &ldquo;Available&rdquo;. Here again, we use the patch command:</p>
<pre tabindex="0"><code>microk8s.kubectl patch pv pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4 -p &#39;{&#34;spec&#34;:{&#34;claimRef&#34;: null}}&#39;
</code></pre><p>Which results in the PV beign in the &ldquo;Available&rdquo; state:</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl get pv
NAME                                      CAPACITY  ACCESS MODES  RECLAIM POLICY  STATUS    CLAIM                STORAGECLASS
pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4  200Gi     RWO           Retain          Available  example/example-pvc  microk8s-hostpath
</code></pre><p>With that, done, one can apply a modified version of the original PVC manifest. Those modifications include a storage size increase to match that of the PV as well as a reference to the PV to bind. Without such reference, the PVC creation would trigger the automatic creation of a new PV by Kubernetes:</p>
<pre tabindex="0"><code>apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: example-pvc
  namespace: example
spec:
  accessModes:
    - ReadWriteOnce
  volumeName: pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4
  resources:
    requests:
      storage: 200Gi
</code></pre><p>After the application of the manifest, we can confirm that our PVC is correctly bound to the original PV, thus ensuring that the data persisted during the PVC update:</p>
<pre tabindex="0"><code>moreillon@home:~/kubernetes$ microk8s.kubectl get pvc -n example
NAME          STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS        AGE
example-pvc   Bound    pvc-6ed2529b-f1da-46ba-bc32-d9b4bbad23a4   200Gi      RWO            microk8s-hostpath   12s
</code></pre>
            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
</div>
    <small class="footer_copyright">
        Â© 2025 Maxime Moreillon.
        
    </small>
</footer>







    
    <script src="https://articles.maximemoreillon.com/js/main.min.4ee188e1744c19816e95a540b2650ed9f033ea0371e74eac8e717355cfca8741.js" integrity="sha256-TuGI4XRMGYFulaVAsmUO2fAz6gNx506sjnFzVc/Kh0E="></script>

    

</body>
</html>
